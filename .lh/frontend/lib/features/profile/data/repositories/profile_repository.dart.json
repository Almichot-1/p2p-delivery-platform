{
    "sourceFile": "frontend/lib/features/profile/data/repositories/profile_repository.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1766327036596,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1766329417925,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,1 +1,64 @@\n+import 'dart:io';\r\n+import 'package:cloud_firestore/cloud_firestore.dart';\r\n+import '../../../../core/services/firebase_service.dart';\r\n+import '../../../../core/services/storage_service.dart';\r\n+import '../../../auth/data/models/user_model.dart';\r\n \r\n+class ProfileRepository {\r\n+  final FirebaseService _firebaseService;\r\n+  final StorageService _storageService;\r\n+\r\n+  ProfileRepository(this._firebaseService, this._storageService);\r\n+\r\n+  // Get user profile\r\n+  Stream<UserModel?> getUserProfile(String userId) {\r\n+    return _firebaseService.usersCollection\r\n+        .doc(userId)\r\n+        .snapshots()\r\n+        .map((doc) => doc.exists ? UserModel.fromFirestore(doc) : null);\r\n+  }\r\n+\r\n+  // Update profile\r\n+  Future<void> updateProfile(UserModel user) async {\r\n+    await _firebaseService.usersCollection\r\n+        .doc(user.uid)\r\n+        .update(user.toFirestore());\r\n+  }\r\n+\r\n+  // Update profile photo\r\n+  Future<String> updateProfilePhoto(File photo) async {\r\n+    final url = await _storageService.uploadProfileImage(photo);\r\n+    \r\n+    final userId = _firebaseService.currentUserId;\r\n+    if (userId != null) {\r\n+      await _firebaseService.usersCollection.doc(userId).update({\r\n+        'photoUrl': url,\r\n+      });\r\n+    }\r\n+    \r\n+    return url;\r\n+  }\r\n+\r\n+  // Upload verification document\r\n+  Future<void> uploadVerificationDocument(File document) async {\r\n+    final url = await _storageService.uploadVerificationDoc(document);\r\n+    \r\n+    final userId = _firebaseService.currentUserId;\r\n+    if (userId != null) {\r\n+      await _firebaseService.usersCollection.doc(userId).update({\r\n+        'verificationDocUrl': url,\r\n+        'verificationStatus': VerificationStatus.pending.name,\r\n+      });\r\n+    }\r\n+  }\r\n+\r\n+  // Update user role\r\n+  Future<void> updateUserRole(UserRole role) async {\r\n+    final userId = _firebaseService.currentUserId;\r\n+    if (userId != null) {\r\n+      await _firebaseService.usersCollection.doc(userId).update({\r\n+        'role': role.name,\r\n+      });\r\n+    }\r\n+  }\r\n+}\n\\ No newline at end of file\n"
                }
            ],
            "date": 1766327036596,
            "name": "Commit-0",
            "content": "\r\n"
        }
    ]
}