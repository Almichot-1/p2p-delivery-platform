{
    "sourceFile": "frontend/lib/features/notifications/data/repositories/notification_repository.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1766327185978,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1766330078723,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,1 +1,81 @@\n+import 'package:cloud_firestore/cloud_firestore.dart';\r\n+import '../../../../core/services/firebase_service.dart';\r\n+import '../models/notification_model.dart';\r\n \r\n+class NotificationRepository {\r\n+  final FirebaseService _firebaseService;\r\n+\r\n+  NotificationRepository(this._firebaseService);\r\n+\r\n+  // Get user notifications\r\n+  Stream<List<NotificationModel>> getUserNotifications(String userId) {\r\n+    return _firebaseService.notificationsCollection\r\n+        .where('userId', isEqualTo: userId)\r\n+        .orderBy('createdAt', descending: true)\r\n+        .limit(50)\r\n+        .snapshots()\r\n+        .map((snapshot) => snapshot.docs\r\n+            .map((doc) => NotificationModel.fromFirestore(doc))\r\n+            .toList());\r\n+  }\r\n+\r\n+  // Get unread count\r\n+  Stream<int> getUnreadCount(String userId) {\r\n+    return _firebaseService.notificationsCollection\r\n+        .where('userId', isEqualTo: userId)\r\n+        .where('isRead', isEqualTo: false)\r\n+        .snapshots()\r\n+        .map((snapshot) => snapshot.docs.length);\r\n+  }\r\n+\r\n+  // Mark as read\r\n+  Future<void> markAsRead(String notificationId) async {\r\n+    await _firebaseService.notificationsCollection\r\n+        .doc(notificationId)\r\n+        .update({'isRead': true});\r\n+  }\r\n+\r\n+  // Mark all as read\r\n+  Future<void> markAllAsRead(String userId) async {\r\n+    final batch = _firebaseService.firestore.batch();\r\n+\r\n+    final unreadNotifications = await _firebaseService.notificationsCollection\r\n+        .where('userId', isEqualTo: userId)\r\n+        .where('isRead', isEqualTo: false)\r\n+        .get();\r\n+\r\n+    for (final doc in unreadNotifications.docs) {\r\n+      batch.update(doc.reference, {'isRead': true});\r\n+    }\r\n+\r\n+    await batch.commit();\r\n+  }\r\n+\r\n+  // Delete notification\r\n+  Future<void> deleteNotification(String notificationId) async {\r\n+    await _firebaseService.notificationsCollection\r\n+        .doc(notificationId)\r\n+        .delete();\r\n+  }\r\n+\r\n+  // Clear all notifications\r\n+  Future<void> clearAllNotifications(String userId) async {\r\n+    final batch = _firebaseService.firestore.batch();\r\n+\r\n+    final notifications = await _firebaseService.notificationsCollection\r\n+        .where('userId', isEqualTo: userId)\r\n+        .get();\r\n+\r\n+    for (final doc in notifications.docs) {\r\n+      batch.delete(doc.reference);\r\n+    }\r\n+\r\n+    await batch.commit();\r\n+  }\r\n+\r\n+  // Create notification (usually called from Cloud Functions)\r\n+  Future<void> createNotification(NotificationModel notification) async {\r\n+    await _firebaseService.notificationsCollection\r\n+        .add(notification.toFirestore());\r\n+  }\r\n+}\n\\ No newline at end of file\n"
                }
            ],
            "date": 1766327185978,
            "name": "Commit-0",
            "content": "\r\n"
        }
    ]
}