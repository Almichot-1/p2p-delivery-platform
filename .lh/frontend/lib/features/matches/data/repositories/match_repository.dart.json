{
    "sourceFile": "frontend/lib/features/matches/data/repositories/match_repository.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1766327121720,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1766328871569,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,1 +1,95 @@\n+import 'package:cloud_firestore/cloud_firestore.dart';\r\n+import '../../../../core/services/firebase_service.dart';\r\n+import '../models/match_model.dart';\r\n \r\n+class MatchRepository {\r\n+  final FirebaseService _firebaseService;\r\n+\r\n+  MatchRepository(this._firebaseService);\r\n+\r\n+  // Get user's matches\r\n+  Stream<List<MatchModel>> getUserMatches(String userId) {\r\n+    return _firebaseService.matchesCollection\r\n+        .where('participants', arrayContains: userId)\r\n+        .orderBy('createdAt', descending: true)\r\n+        .snapshots()\r\n+        .map((snapshot) =>\r\n+            snapshot.docs.map((doc) => MatchModel.fromFirestore(doc)).toList());\r\n+  }\r\n+\r\n+  // Get single match\r\n+  Stream<MatchModel?> getMatchById(String matchId) {\r\n+    return _firebaseService.matchesCollection\r\n+        .doc(matchId)\r\n+        .snapshots()\r\n+        .map((doc) => doc.exists ? MatchModel.fromFirestore(doc) : null);\r\n+  }\r\n+\r\n+  // Create match\r\n+  Future<String> createMatch(MatchModel match) async {\r\n+    final docRef =\r\n+        await _firebaseService.matchesCollection.add(match.toFirestore());\r\n+    return docRef.id;\r\n+  }\r\n+\r\n+  // Update match status\r\n+  Future<void> updateMatchStatus(String matchId, MatchStatus status) async {\r\n+    final updateData = <String, dynamic>{\r\n+      'status': status.name,\r\n+      'updatedAt': FieldValue.serverTimestamp(),\r\n+    };\r\n+\r\n+    if (status == MatchStatus.confirmed) {\r\n+      updateData['confirmedAt'] = FieldValue.serverTimestamp();\r\n+    } else if (status == MatchStatus.completed) {\r\n+      updateData['completedAt'] = FieldValue.serverTimestamp();\r\n+    }\r\n+\r\n+    await _firebaseService.matchesCollection.doc(matchId).update(updateData);\r\n+  }\r\n+\r\n+  // Accept match (by traveler)\r\n+  Future<void> acceptMatch(String matchId) async {\r\n+    await updateMatchStatus(matchId, MatchStatus.accepted);\r\n+  }\r\n+\r\n+  // Reject match\r\n+  Future<void> rejectMatch(String matchId) async {\r\n+    await updateMatchStatus(matchId, MatchStatus.rejected);\r\n+  }\r\n+\r\n+  // Confirm match (final confirmation by both parties)\r\n+  Future<void> confirmMatch(String matchId) async {\r\n+    await updateMatchStatus(matchId, MatchStatus.confirmed);\r\n+  }\r\n+\r\n+  // Update delivery status\r\n+  Future<void> markAsPickedUp(String matchId) async {\r\n+    await updateMatchStatus(matchId, MatchStatus.pickedUp);\r\n+  }\r\n+\r\n+  Future<void> markAsInTransit(String matchId) async {\r\n+    await updateMatchStatus(matchId, MatchStatus.inTransit);\r\n+  }\r\n+\r\n+  Future<void> markAsDelivered(String matchId) async {\r\n+    await updateMatchStatus(matchId, MatchStatus.delivered);\r\n+  }\r\n+\r\n+  Future<void> completeMatch(String matchId) async {\r\n+    await updateMatchStatus(matchId, MatchStatus.completed);\r\n+  }\r\n+\r\n+  // Cancel match\r\n+  Future<void> cancelMatch(String matchId) async {\r\n+    await updateMatchStatus(matchId, MatchStatus.cancelled);\r\n+  }\r\n+\r\n+  // Update agreed price\r\n+  Future<void> updateAgreedPrice(String matchId, double price) async {\r\n+    await _firebaseService.matchesCollection.doc(matchId).update({\r\n+      'agreedPrice': price,\r\n+      'updatedAt': FieldValue.serverTimestamp(),\r\n+    });\r\n+  }\r\n+}\n\\ No newline at end of file\n"
                }
            ],
            "date": 1766327121720,
            "name": "Commit-0",
            "content": "\r\n"
        }
    ]
}