{
    "sourceFile": "frontend/lib/features/auth/presentation/screens/verify_phone_screen.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1766327036524,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1766333976727,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,1 +1,181 @@\n+import 'dart:async';\r\n+import 'package:flutter/material.dart';\r\n+import 'package:flutter_bloc/flutter_bloc.dart';\r\n+import 'package:go_router/go_router.dart';\r\n \r\n+import '../../../../core/constants/route_constants.dart';\r\n+import '../../../../core/theme/app_colors.dart';\r\n+import '../../../../core/theme/app_text_styles.dart';\r\n+import '../../../../core/utils/helpers.dart';\r\n+import '../../../../core/widgets/custom_button.dart';\r\n+import '../../bloc/auth_bloc.dart';\r\n+import '../../bloc/auth_event.dart';\r\n+import '../../bloc/auth_state.dart';\r\n+import '../widgets/auth_header.dart';\r\n+import '../widgets/otp_input_field.dart';\r\n+\r\n+class VerifyPhoneScreen extends StatefulWidget {\r\n+  final String verificationId;\r\n+  final String phoneNumber;\r\n+\r\n+  const VerifyPhoneScreen({\r\n+    super.key,\r\n+    required this.verificationId,\r\n+    required this.phoneNumber,\r\n+  });\r\n+\r\n+  @override\r\n+  State<VerifyPhoneScreen> createState() => _VerifyPhoneScreenState();\r\n+}\r\n+\r\n+class _VerifyPhoneScreenState extends State<VerifyPhoneScreen> {\r\n+  String _otp = '';\r\n+  int _resendSeconds = 60;\r\n+  Timer? _timer;\r\n+  bool _canResend = false;\r\n+\r\n+  @override\r\n+  void initState() {\r\n+    super.initState();\r\n+    _startResendTimer();\r\n+  }\r\n+\r\n+  @override\r\n+  void dispose() {\r\n+    _timer?.cancel();\r\n+    super.dispose();\r\n+  }\r\n+\r\n+  void _startResendTimer() {\r\n+    _resendSeconds = 60;\r\n+    _canResend = false;\r\n+    _timer?.cancel();\r\n+    _timer = Timer.periodic(const Duration(seconds: 1), (timer) {\r\n+      setState(() {\r\n+        if (_resendSeconds > 0) {\r\n+          _resendSeconds--;\r\n+        } else {\r\n+          _canResend = true;\r\n+          timer.cancel();\r\n+        }\r\n+      });\r\n+    });\r\n+  }\r\n+\r\n+  void _verifyOTP() {\r\n+    if (_otp.length != 6) {\r\n+      Helpers.showErrorSnackBar(context, 'Please enter the complete code');\r\n+      return;\r\n+    }\r\n+\r\n+    context.read<AuthBloc>().add(\r\n+          AuthPhoneOTPVerified(\r\n+            verificationId: widget.verificationId,\r\n+            otp: _otp,\r\n+          ),\r\n+        );\r\n+  }\r\n+\r\n+  void _resendOTP() {\r\n+    if (!_canResend) return;\r\n+\r\n+    context.read<AuthBloc>().add(\r\n+          AuthPhoneOTPRequested(phoneNumber: widget.phoneNumber),\r\n+        );\r\n+    _startResendTimer();\r\n+  }\r\n+\r\n+  @override\r\n+  Widget build(BuildContext context) {\r\n+    return BlocListener<AuthBloc, AuthState>(\r\n+      listener: (context, state) {\r\n+        if (state is AuthAuthenticated) {\r\n+          context.go(RouteConstants.home);\r\n+        } else if (state is AuthError) {\r\n+          Helpers.showErrorSnackBar(context, state.message);\r\n+        } else if (state is AuthPhoneOTPSent) {\r\n+          Helpers.showSuccessSnackBar(context, 'Code resent!');\r\n+        }\r\n+      },\r\n+      child: Scaffold(\r\n+        appBar: AppBar(\r\n+          leading: IconButton(\r\n+            icon: const Icon(Icons.arrow_back),\r\n+            onPressed: () => context.pop(),\r\n+          ),\r\n+        ),\r\n+        body: SafeArea(\r\n+          child: Padding(\r\n+            padding: const EdgeInsets.all(24),\r\n+            child: Column(\r\n+              crossAxisAlignment: CrossAxisAlignment.stretch,\r\n+              children: [\r\n+                const AuthHeader(\r\n+                  title: 'Verify Phone',\r\n+                  subtitle: 'Enter the 6-digit code sent to',\r\n+                ),\r\n+                const SizedBox(height: 8),\r\n+                Text(\r\n+                  widget.phoneNumber,\r\n+                  style: AppTextStyles.h5.copyWith(\r\n+                    color: AppColors.primary,\r\n+                  ),\r\n+                ),\r\n+                const SizedBox(height: 40),\r\n+\r\n+                // OTP Input\r\n+                OTPInputField(\r\n+                  onCompleted: (otp) {\r\n+                    setState(() {\r\n+                      _otp = otp;\r\n+                    });\r\n+                    _verifyOTP();\r\n+                  },\r\n+                  onChanged: (otp) {\r\n+                    setState(() {\r\n+                      _otp = otp;\r\n+                    });\r\n+                  },\r\n+                ),\r\n+                const SizedBox(height: 32),\r\n+\r\n+                // Verify button\r\n+                BlocBuilder<AuthBloc, AuthState>(\r\n+                  builder: (context, state) {\r\n+                    return CustomButton(\r\n+                      text: 'Verify',\r\n+                      onPressed: _otp.length == 6 ? _verifyOTP : null,\r\n+                      isLoading: state is AuthLoading,\r\n+                    );\r\n+                  },\r\n+                ),\r\n+                const SizedBox(height: 24),\r\n+\r\n+                // Resend code\r\n+                Center(\r\n+                  child: _canResend\r\n+                      ? TextButton(\r\n+                          onPressed: _resendOTP,\r\n+                          child: Text(\r\n+                            'Resend Code',\r\n+                            style: AppTextStyles.bodyMedium.copyWith(\r\n+                              color: AppColors.primary,\r\n+                              fontWeight: FontWeight.w600,\r\n+                            ),\r\n+                          ),\r\n+                        )\r\n+                      : Text(\r\n+                          'Resend code in ${_resendSeconds}s',\r\n+                          style: AppTextStyles.bodyMedium.copyWith(\r\n+                            color: AppColors.grey600,\r\n+                          ),\r\n+                        ),\r\n+                ),\r\n+              ],\r\n+            ),\r\n+          ),\r\n+        ),\r\n+      ),\r\n+    );\r\n+  }\r\n+}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1766335588391,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -16,13 +16,15 @@\n \r\n class VerifyPhoneScreen extends StatefulWidget {\r\n   final String verificationId;\r\n   final String phoneNumber;\r\n+  final String fullName;\r\n \r\n   const VerifyPhoneScreen({\r\n     super.key,\r\n     required this.verificationId,\r\n     required this.phoneNumber,\r\n+    required this.fullName,\r\n   });\r\n \r\n   @override\r\n   State<VerifyPhoneScreen> createState() => _VerifyPhoneScreenState();\r\n@@ -71,8 +73,9 @@\n     context.read<AuthBloc>().add(\r\n           AuthPhoneOTPVerified(\r\n             verificationId: widget.verificationId,\r\n             otp: _otp,\r\n+            fullName: widget.fullName,\r\n           ),\r\n         );\r\n   }\r\n \r\n"
                }
            ],
            "date": 1766327036524,
            "name": "Commit-0",
            "content": "\r\n"
        }
    ]
}