{
    "sourceFile": "lib/features/auth/presentation/screens/login_screen.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1768062522395,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1768062522395,
            "name": "Commit-0",
            "content": "import 'package:flutter/material.dart';\r\nimport 'package:flutter_bloc/flutter_bloc.dart';\r\nimport 'package:firebase_core/firebase_core.dart';\r\nimport 'package:go_router/go_router.dart';\r\n\r\nimport '../../../../config/routes.dart';\r\nimport '../../../../core/widgets/custom_button.dart';\r\nimport '../../../../core/widgets/custom_text_field.dart';\r\nimport '../../bloc/auth_bloc.dart';\r\nimport '../../bloc/auth_event.dart';\r\nimport '../../bloc/auth_state.dart';\r\nimport '../widgets/auth_header.dart';\r\n\r\nclass LoginScreen extends StatefulWidget {\r\n  const LoginScreen({super.key});\r\n\r\n  @override\r\n  State<LoginScreen> createState() => _LoginScreenState();\r\n}\r\n\r\nclass _LoginScreenState extends State<LoginScreen> {\r\n  final _formKey = GlobalKey<FormState>();\r\n  final _emailCtrl = TextEditingController();\r\n  final _passwordCtrl = TextEditingController();\r\n\r\n  @override\r\n  void dispose() {\r\n    _emailCtrl.dispose();\r\n    _passwordCtrl.dispose();\r\n    super.dispose();\r\n  }\r\n\r\n  void _submit() {\r\n    if (!(_formKey.currentState?.validate() ?? false)) return;\r\n    context.read<AuthBloc>().add(\r\n          AuthLoginRequested(\r\n            email: _emailCtrl.text,\r\n            password: _passwordCtrl.text,\r\n          ),\r\n        );\r\n  }\r\n\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    final firebaseConfigured = Firebase.apps.isNotEmpty;\r\n    return BlocListener<AuthBloc, AuthState>(\r\n      listener: (context, state) {\r\n        if (state is AuthAuthenticated) {\r\n          context.go(RoutePaths.home);\r\n        } else if (state is AuthError) {\r\n          ScaffoldMessenger.of(context).showSnackBar(\r\n            SnackBar(content: Text(state.message)),\r\n          );\r\n        }\r\n      },\r\n      child: Scaffold(\r\n        body: SafeArea(\r\n          child: SingleChildScrollView(\r\n            padding: const EdgeInsets.all(20),\r\n            child: Form(\r\n              key: _formKey,\r\n              child: Column(\r\n                crossAxisAlignment: CrossAxisAlignment.stretch,\r\n                children: [\r\n                  const AuthHeader(\r\n                    title: 'Welcome Back',\r\n                    subtitle: 'Log in to continue.',\r\n                  ),\r\n                  if (!firebaseConfigured) ...[\r\n                    const SizedBox(height: 12),\r\n                    Text(\r\n                      'Firebase is not configured for Android yet. Add android/app/google-services.json to enable real login/register.',\r\n                      style: TextStyle(color: Theme.of(context).colorScheme.error),\r\n                      textAlign: TextAlign.center,\r\n                    ),\r\n                  ],\r\n                  const SizedBox(height: 20),\r\n                  CustomTextField(\r\n                    controller: _emailCtrl,\r\n                    label: 'Email',\r\n                    hint: 'you@example.com',\r\n                    keyboardType: TextInputType.emailAddress,\r\n                    prefixIcon: Icons.email_outlined,\r\n                    validator: (v) {\r\n                      final value = (v ?? '').trim();\r\n                      if (value.isEmpty) return 'Email is required';\r\n                      if (!value.contains('@')) return 'Enter a valid email';\r\n                      return null;\r\n                    },\r\n                  ),\r\n                  const SizedBox(height: 12),\r\n                  CustomTextField(\r\n                    controller: _passwordCtrl,\r\n                    label: 'Password',\r\n                    obscureText: true,\r\n                    prefixIcon: Icons.lock_outline,\r\n                    validator: (v) {\r\n                      final value = (v ?? '');\r\n                      if (value.isEmpty) return 'Password is required';\r\n                      if (value.length < 6) return 'Minimum 6 characters';\r\n                      return null;\r\n                    },\r\n                  ),\r\n                  Align(\r\n                    alignment: Alignment.centerRight,\r\n                    child: TextButton(\r\n                      onPressed: () => context.go(RoutePaths.forgotPassword),\r\n                      child: const Text('Forgot Password?'),\r\n                    ),\r\n                  ),\r\n                  const SizedBox(height: 8),\r\n                  BlocBuilder<AuthBloc, AuthState>(\r\n                    builder: (context, state) {\r\n                      final loading = state is AuthLoading;\r\n                      return CustomButton(\r\n                        label: 'Login',\r\n                        isLoading: loading,\r\n                        onPressed: loading ? null : _submit,\r\n                      );\r\n                    },\r\n                  ),\r\n                  const SizedBox(height: 14),\r\n                  Row(\r\n                    children: [\r\n                      const Expanded(child: Divider()),\r\n                      Padding(\r\n                        padding: const EdgeInsets.symmetric(horizontal: 12),\r\n                        child: Text(\r\n                          'or',\r\n                          style: Theme.of(context).textTheme.bodySmall,\r\n                        ),\r\n                      ),\r\n                      const Expanded(child: Divider()),\r\n                    ],\r\n                  ),\r\n                  const SizedBox(height: 14),\r\n                  BlocBuilder<AuthBloc, AuthState>(\r\n                    builder: (context, state) {\r\n                      final loading = state is AuthLoading;\r\n                      return OutlinedButton(\r\n                        onPressed: loading\r\n                            ? null\r\n                            : () => context.read<AuthBloc>().add(\r\n                                  const AuthGoogleSignInRequested(),\r\n                                ),\r\n                        style: OutlinedButton.styleFrom(\r\n                          padding: const EdgeInsets.symmetric(vertical: 14),\r\n                        ),\r\n                        child: Row(\r\n                          mainAxisAlignment: MainAxisAlignment.center,\r\n                          children: [\r\n                            Container(\r\n                              width: 22,\r\n                              height: 22,\r\n                              alignment: Alignment.center,\r\n                              decoration: BoxDecoration(\r\n                                shape: BoxShape.circle,\r\n                                border: Border.all(\r\n                                  color: Theme.of(context).colorScheme.outline,\r\n                                ),\r\n                              ),\r\n                              child: const Text(\r\n                                'G',\r\n                                style: TextStyle(fontWeight: FontWeight.w800),\r\n                              ),\r\n                            ),\r\n                            const SizedBox(width: 10),\r\n                            const Text('Continue with Google'),\r\n                          ],\r\n                        ),\r\n                      );\r\n                    },\r\n                  ),\r\n                  const SizedBox(height: 12),\r\n                  Row(\r\n                    mainAxisAlignment: MainAxisAlignment.center,\r\n                    children: [\r\n                      const Text(\"Don't have account? \"),\r\n                      TextButton(\r\n                        onPressed: () => context.go(RoutePaths.register),\r\n                        child: const Text('Register'),\r\n                      ),\r\n                    ],\r\n                  ),\r\n                ],\r\n              ),\r\n            ),\r\n          ),\r\n        ),\r\n      ),\r\n    );\r\n  }\r\n}\r\n"
        }
    ]
}