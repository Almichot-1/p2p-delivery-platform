{
    "sourceFile": "lib/features/trips/data/models/trip_model.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1768064743291,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1768064743290,
            "name": "Commit-0",
            "content": "import 'package:cloud_firestore/cloud_firestore.dart';\r\nimport 'package:equatable/equatable.dart';\r\n\r\nenum TripStatus { active, completed, cancelled }\r\n\r\nclass TripModel extends Equatable {\r\n  const TripModel({\r\n    required this.id,\r\n    required this.travelerId,\r\n    required this.travelerName,\r\n    this.travelerPhoto,\r\n    this.travelerRating = 0.0,\r\n    required this.originCity,\r\n    required this.originCountry,\r\n    required this.destinationCity,\r\n    required this.destinationCountry,\r\n    required this.departureDate,\r\n    this.returnDate,\r\n    required this.availableCapacityKg,\r\n    this.pricePerKg,\r\n    this.acceptedItemTypes = const <String>[],\r\n    this.notes,\r\n    this.status = TripStatus.active,\r\n    this.matchCount = 0,\r\n    this.createdAt,\r\n    this.updatedAt,\r\n  });\r\n\r\n  final String id;\r\n\r\n  final String travelerId;\r\n  final String travelerName;\r\n  final String? travelerPhoto;\r\n  final double travelerRating;\r\n\r\n  final String originCity;\r\n  final String originCountry;\r\n  final String destinationCity;\r\n  final String destinationCountry;\r\n\r\n  final DateTime departureDate;\r\n  final DateTime? returnDate;\r\n\r\n  final double availableCapacityKg;\r\n  final double? pricePerKg;\r\n\r\n  final List<String> acceptedItemTypes;\r\n  final String? notes;\r\n\r\n  final TripStatus status;\r\n  final int matchCount;\r\n\r\n  final DateTime? createdAt;\r\n  final DateTime? updatedAt;\r\n\r\n  factory TripModel.fromFirestore(DocumentSnapshot<Map<String, dynamic>> doc) {\r\n    final data = doc.data();\r\n    if (data == null) {\r\n      throw Exception('Trip document is empty for id=${doc.id}');\r\n    }\r\n\r\n    DateTime? tsToDate(dynamic v) {\r\n      if (v is Timestamp) return v.toDate();\r\n      return null;\r\n    }\r\n\r\n    TripStatus parseStatus(dynamic v) {\r\n      final s = (v ?? '').toString();\r\n      switch (s) {\r\n        case 'completed':\r\n          return TripStatus.completed;\r\n        case 'cancelled':\r\n          return TripStatus.cancelled;\r\n        case 'active':\r\n        default:\r\n          return TripStatus.active;\r\n      }\r\n    }\r\n\r\n    return TripModel(\r\n      id: doc.id,\r\n      travelerId: data['travelerId']?.toString() ?? '',\r\n      travelerName: data['travelerName']?.toString() ?? '',\r\n      travelerPhoto: data['travelerPhoto']?.toString(),\r\n      travelerRating: (data['travelerRating'] as num?)?.toDouble() ?? 0.0,\r\n      originCity: data['originCity']?.toString() ?? '',\r\n      originCountry: data['originCountry']?.toString() ?? '',\r\n      destinationCity: data['destinationCity']?.toString() ?? '',\r\n      destinationCountry: data['destinationCountry']?.toString() ?? '',\r\n      departureDate: tsToDate(data['departureDate']) ?? DateTime.fromMillisecondsSinceEpoch(0),\r\n      returnDate: tsToDate(data['returnDate']),\r\n      availableCapacityKg: (data['availableCapacityKg'] as num?)?.toDouble() ?? 0.0,\r\n      pricePerKg: (data['pricePerKg'] as num?)?.toDouble(),\r\n      acceptedItemTypes: (data['acceptedItemTypes'] is Iterable)\r\n          ? (data['acceptedItemTypes'] as Iterable)\r\n              .map((e) => e.toString())\r\n              .toList(growable: false)\r\n          : const <String>[],\r\n      notes: data['notes']?.toString(),\r\n      status: parseStatus(data['status']),\r\n      matchCount: (data['matchCount'] as num?)?.toInt() ?? 0,\r\n      createdAt: tsToDate(data['createdAt']),\r\n      updatedAt: tsToDate(data['updatedAt']),\r\n    );\r\n  }\r\n\r\n  Map<String, dynamic> toFirestore() {\r\n    return <String, dynamic>{\r\n      'travelerId': travelerId,\r\n      'travelerName': travelerName,\r\n      'travelerPhoto': travelerPhoto,\r\n      'travelerRating': travelerRating,\r\n      'originCity': originCity,\r\n      'originCountry': originCountry,\r\n      'destinationCity': destinationCity,\r\n      'destinationCountry': destinationCountry,\r\n      'departureDate': Timestamp.fromDate(departureDate),\r\n      'returnDate': returnDate == null ? null : Timestamp.fromDate(returnDate!),\r\n      'availableCapacityKg': availableCapacityKg,\r\n      'pricePerKg': pricePerKg,\r\n      'acceptedItemTypes': acceptedItemTypes,\r\n      'notes': notes,\r\n      'status': status.name,\r\n      'matchCount': matchCount,\r\n      'createdAt': createdAt == null ? null : Timestamp.fromDate(createdAt!),\r\n      'updatedAt': updatedAt == null ? null : Timestamp.fromDate(updatedAt!),\r\n    }..removeWhere((key, value) => value == null);\r\n  }\r\n\r\n  TripModel copyWith({\r\n    String? id,\r\n    String? travelerId,\r\n    String? travelerName,\r\n    String? travelerPhoto,\r\n    double? travelerRating,\r\n    String? originCity,\r\n    String? originCountry,\r\n    String? destinationCity,\r\n    String? destinationCountry,\r\n    DateTime? departureDate,\r\n    DateTime? returnDate,\r\n    double? availableCapacityKg,\r\n    double? pricePerKg,\r\n    List<String>? acceptedItemTypes,\r\n    String? notes,\r\n    TripStatus? status,\r\n    int? matchCount,\r\n    DateTime? createdAt,\r\n    DateTime? updatedAt,\r\n  }) {\r\n    return TripModel(\r\n      id: id ?? this.id,\r\n      travelerId: travelerId ?? this.travelerId,\r\n      travelerName: travelerName ?? this.travelerName,\r\n      travelerPhoto: travelerPhoto ?? this.travelerPhoto,\r\n      travelerRating: travelerRating ?? this.travelerRating,\r\n      originCity: originCity ?? this.originCity,\r\n      originCountry: originCountry ?? this.originCountry,\r\n      destinationCity: destinationCity ?? this.destinationCity,\r\n      destinationCountry: destinationCountry ?? this.destinationCountry,\r\n      departureDate: departureDate ?? this.departureDate,\r\n      returnDate: returnDate ?? this.returnDate,\r\n      availableCapacityKg: availableCapacityKg ?? this.availableCapacityKg,\r\n      pricePerKg: pricePerKg ?? this.pricePerKg,\r\n      acceptedItemTypes: acceptedItemTypes ?? this.acceptedItemTypes,\r\n      notes: notes ?? this.notes,\r\n      status: status ?? this.status,\r\n      matchCount: matchCount ?? this.matchCount,\r\n      createdAt: createdAt ?? this.createdAt,\r\n      updatedAt: updatedAt ?? this.updatedAt,\r\n    );\r\n  }\r\n\r\n  String get _originLabel {\r\n    final v = originCountry.trim();\r\n    return v.isEmpty ? originCity : v;\r\n  }\r\n\r\n  String get _destinationLabel {\r\n    final v = destinationCountry.trim();\r\n    if (v.isNotEmpty && v != 'Ethiopia') return v;\r\n    final fallback = destinationCity.trim();\r\n    return fallback.isEmpty ? v : fallback;\r\n  }\r\n\r\n  String get routeDisplay => '$_originLabel â†’ $_destinationLabel';\r\n\r\n  DateTime get _startOfToday {\r\n    final now = DateTime.now();\r\n    return DateTime(now.year, now.month, now.day);\r\n  }\r\n\r\n  bool get isUpcoming => !departureDate.isBefore(_startOfToday);\r\n\r\n  bool get isPast => departureDate.isBefore(_startOfToday);\r\n\r\n  @override\r\n  List<Object?> get props => <Object?>[\r\n        id,\r\n        travelerId,\r\n        travelerName,\r\n        travelerPhoto,\r\n        travelerRating,\r\n        originCity,\r\n        originCountry,\r\n        destinationCity,\r\n        destinationCountry,\r\n        departureDate,\r\n        returnDate,\r\n        availableCapacityKg,\r\n        pricePerKg,\r\n        acceptedItemTypes,\r\n        notes,\r\n        status,\r\n        matchCount,\r\n        createdAt,\r\n        updatedAt,\r\n      ];\r\n}\r\n"
        }
    ]
}