{
    "sourceFile": "lib/config/routes.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1768056558275,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1768056558275,
            "name": "Commit-0",
            "content": "import 'dart:async';\r\n\r\nimport 'package:flutter/material.dart';\r\nimport 'package:go_router/go_router.dart';\r\n\r\nimport '../features/auth/bloc/auth_bloc.dart';\r\nimport '../features/auth/bloc/auth_state.dart';\r\n\r\nimport '../features/auth/presentation/screens/forgot_password_screen.dart';\r\nimport '../features/auth/presentation/screens/login_screen.dart';\r\nimport '../features/auth/presentation/screens/onboarding_screen.dart';\r\nimport '../features/auth/presentation/screens/register_screen.dart';\r\nimport '../features/auth/presentation/screens/splash_screen.dart';\r\nimport '../features/home/presentation/screens/home_screen.dart';\r\nimport '../features/home/presentation/screens/search_screen.dart';\r\nimport '../features/notifications/presentation/screens/notifications_screen.dart';\r\nimport '../features/profile/presentation/screens/edit_profile_screen.dart';\r\nimport '../features/profile/presentation/screens/profile_screen.dart';\r\nimport '../features/profile/presentation/screens/public_profile_screen.dart';\r\nimport '../features/profile/presentation/screens/settings_screen.dart';\r\nimport '../features/trips/presentation/screens/create_trip_screen.dart';\r\nimport '../features/trips/presentation/screens/my_trips_screen.dart';\r\nimport '../features/trips/presentation/screens/matching_requests_screen.dart';\r\nimport '../features/trips/presentation/screens/trip_details_screen.dart';\r\nimport '../features/trips/presentation/screens/trips_list_screen.dart';\r\nimport '../features/trips/data/models/trip_model.dart';\r\nimport '../features/requests/presentation/screens/requests_list_screen.dart';\r\nimport '../features/requests/presentation/screens/create_request_screen.dart';\r\nimport '../features/requests/presentation/screens/request_details_screen.dart';\r\nimport '../features/requests/presentation/screens/my_requests_screen.dart';\r\nimport '../features/requests/presentation/screens/matching_trips_screen.dart';\r\nimport '../features/requests/data/models/request_model.dart';\r\nimport '../features/matches/presentation/screens/matches_screen.dart';\r\nimport '../features/matches/presentation/screens/match_details_screen.dart';\r\nimport '../features/chat/presentation/screens/chat_screen.dart';\r\nimport '../features/chat/presentation/screens/conversations_screen.dart';\r\n\r\nclass RouteNames {\r\n  static const String splash = 'splash';\r\n  static const String onboarding = 'onboarding';\r\n  static const String login = 'login';\r\n  static const String register = 'register';\r\n  static const String forgotPassword = 'forgot-password';\r\n  static const String home = 'home';\r\n  static const String profile = 'profile';\r\n  static const String trips = 'trips';\r\n  static const String requests = 'requests';\r\n  static const String matches = 'matches';\r\n  static const String chat = 'chat';\r\n  static const String conversations = 'conversations';\r\n  static const String notifications = 'notifications';\r\n  static const String tripsCreate = 'trips-create';\r\n  static const String myTrips = 'my-trips';\r\n  static const String requestsCreate = 'requests-create';\r\n  static const String myRequests = 'my-requests';\r\n}\r\n\r\nclass RoutePaths {\r\n  static const String splash = '/splash';\r\n  static const String onboarding = '/onboarding';\r\n  static const String login = '/login';\r\n  static const String register = '/register';\r\n  static const String forgotPassword = '/forgot-password';\r\n  static const String home = '/home';\r\n  static const String search = '/search';\r\n  static const String profile = '/profile';\r\n  static const String publicProfile = '/profile/:uid';\r\n  static const String profileEdit = '/profile/edit';\r\n  static const String settings = '/settings';\r\n  static const String notifications = '/notifications';\r\n  static const String trips = '/trips';\r\n  static const String tripsCreate = '/trips/create';\r\n  static const String myTrips = '/my-trips';\r\n  static const String requests = '/requests';\r\n  static const String requestsCreate = '/requests/create';\r\n  static const String myRequests = '/my-requests';\r\n  static const String matches = '/matches';\r\n  static const String chat = '/chat';\r\n  static const String conversations = '/conversations';\r\n}\r\n\r\nclass AppRoutes {\r\n  static GoRouter createRouter(AuthBloc authBloc) {\r\n    bool isLoggedIn(AuthState s) => s is AuthAuthenticated;\r\n\r\n    return GoRouter(\r\n      initialLocation: RoutePaths.splash,\r\n      refreshListenable: _GoRouterRefreshStream(authBloc.stream),\r\n      redirect: (context, state) {\r\n        final loggedIn = isLoggedIn(authBloc.state);\r\n        final location = state.uri.path;\r\n\r\n        final isAuthScreen =\r\n            location == RoutePaths.login || location == RoutePaths.register;\r\n        final isPublic = location == RoutePaths.splash ||\r\n            location == RoutePaths.onboarding ||\r\n            location == RoutePaths.login ||\r\n            location == RoutePaths.register ||\r\n            location == RoutePaths.forgotPassword;\r\n\r\n        if (loggedIn && isAuthScreen) return RoutePaths.home;\r\n        if (!loggedIn && !isPublic) return RoutePaths.login;\r\n        return null;\r\n      },\r\n      routes: <GoRoute>[\r\n        GoRoute(\r\n          name: RouteNames.splash,\r\n          path: RoutePaths.splash,\r\n          builder: (context, state) => const SplashScreen(),\r\n        ),\r\n        GoRoute(\r\n          name: RouteNames.onboarding,\r\n          path: RoutePaths.onboarding,\r\n          builder: (context, state) => const OnboardingScreen(),\r\n        ),\r\n        GoRoute(\r\n          name: RouteNames.login,\r\n          path: RoutePaths.login,\r\n          builder: (context, state) => const LoginScreen(),\r\n        ),\r\n        GoRoute(\r\n          name: RouteNames.register,\r\n          path: RoutePaths.register,\r\n          builder: (context, state) => const RegisterScreen(),\r\n        ),\r\n        GoRoute(\r\n          name: RouteNames.forgotPassword,\r\n          path: RoutePaths.forgotPassword,\r\n          builder: (context, state) => const ForgotPasswordScreen(),\r\n        ),\r\n        GoRoute(\r\n          name: RouteNames.home,\r\n          path: RoutePaths.home,\r\n          builder: (context, state) => const HomeScreen(),\r\n        ),\r\n        GoRoute(\r\n          path: RoutePaths.search,\r\n          builder: (context, state) => const SearchScreen(),\r\n        ),\r\n        GoRoute(\r\n          name: RouteNames.profile,\r\n          path: RoutePaths.profile,\r\n          builder: (context, state) => const ProfileScreen(),\r\n        ),\r\n        GoRoute(\r\n          path: RoutePaths.publicProfile,\r\n          builder: (context, state) {\r\n            final uid = state.pathParameters['uid'] ?? '';\r\n            return PublicProfileScreen(uid: uid);\r\n          },\r\n        ),\r\n        GoRoute(\r\n          path: RoutePaths.profileEdit,\r\n          builder: (context, state) => const EditProfileScreen(),\r\n        ),\r\n        GoRoute(\r\n          path: RoutePaths.settings,\r\n          builder: (context, state) => const SettingsScreen(),\r\n        ),\r\n        GoRoute(\r\n          name: RouteNames.notifications,\r\n          path: RoutePaths.notifications,\r\n          builder: (context, state) => const NotificationsScreen(),\r\n        ),\r\n        GoRoute(\r\n          name: RouteNames.tripsCreate,\r\n          path: RoutePaths.tripsCreate,\r\n          builder: (context, state) {\r\n            final existing = state.extra;\r\n            return CreateTripScreen(\r\n                existing: existing is TripModel ? existing : null);\r\n          },\r\n        ),\r\n        GoRoute(\r\n          name: RouteNames.trips,\r\n          path: RoutePaths.trips,\r\n          builder: (context, state) => const TripsListScreen(),\r\n        ),\r\n        GoRoute(\r\n          path: '${RoutePaths.trips}/:id',\r\n          builder: (context, state) {\r\n            final id = state.pathParameters['id'] ?? '';\r\n            return TripDetailsScreen(tripId: id);\r\n          },\r\n        ),\r\n        GoRoute(\r\n          path: '${RoutePaths.trips}/:tripId/matching-requests',\r\n          builder: (context, state) {\r\n            final id = state.pathParameters['tripId'] ?? '';\r\n            return MatchingRequestsScreen(tripId: id);\r\n          },\r\n        ),\r\n        GoRoute(\r\n          name: RouteNames.myTrips,\r\n          path: RoutePaths.myTrips,\r\n          builder: (context, state) => const MyTripsScreen(),\r\n        ),\r\n        GoRoute(\r\n          name: RouteNames.requests,\r\n          path: RoutePaths.requests,\r\n          builder: (context, state) => const RequestsListScreen(),\r\n        ),\r\n        GoRoute(\r\n          name: RouteNames.requestsCreate,\r\n          path: RoutePaths.requestsCreate,\r\n          builder: (context, state) {\r\n            final existing = state.extra;\r\n            return CreateRequestScreen(\r\n              existing: existing is RequestModel ? existing : null,\r\n              fromTrip: existing is CreateRequestFromTrip ? existing : null,\r\n            );\r\n          },\r\n        ),\r\n        GoRoute(\r\n          path: '${RoutePaths.requests}/:id',\r\n          builder: (context, state) {\r\n            final id = state.pathParameters['id'] ?? '';\r\n            return RequestDetailsScreen(requestId: id);\r\n          },\r\n        ),\r\n        GoRoute(\r\n          path: '${RoutePaths.requests}/:requestId/matching-trips',\r\n          builder: (context, state) {\r\n            final id = state.pathParameters['requestId'] ?? '';\r\n            return MatchingTripsScreen(requestId: id);\r\n          },\r\n        ),\r\n        GoRoute(\r\n          name: RouteNames.myRequests,\r\n          path: RoutePaths.myRequests,\r\n          builder: (context, state) => const MyRequestsScreen(),\r\n        ),\r\n        GoRoute(\r\n          name: RouteNames.matches,\r\n          path: RoutePaths.matches,\r\n          builder: (context, state) => const MatchesScreen(),\r\n        ),\r\n        GoRoute(\r\n          path: '${RoutePaths.matches}/:id',\r\n          builder: (context, state) {\r\n            final id = state.pathParameters['id'] ?? '';\r\n            return MatchDetailsScreen(matchId: id);\r\n          },\r\n        ),\r\n        GoRoute(\r\n          name: RouteNames.conversations,\r\n          path: RoutePaths.conversations,\r\n          builder: (context, state) => const ConversationsScreen(),\r\n        ),\r\n        GoRoute(\r\n          path: '${RoutePaths.chat}/:matchId',\r\n          builder: (context, state) {\r\n            final matchId = state.pathParameters['matchId'] ?? '';\r\n            return ChatScreen(matchId: matchId);\r\n          },\r\n        ),\r\n      ],\r\n    );\r\n  }\r\n}\r\n\r\nclass _GoRouterRefreshStream extends ChangeNotifier {\r\n  _GoRouterRefreshStream(Stream<dynamic> stream) {\r\n    _subscription = stream.listen((_) => notifyListeners());\r\n  }\r\n\r\n  late final StreamSubscription<dynamic> _subscription;\r\n\r\n  @override\r\n  void dispose() {\r\n    _subscription.cancel();\r\n    super.dispose();\r\n  }\r\n}\r\n"
        }
    ]
}